import jsonimport timefrom termcolor import coloredimport osimport sysimport shutilimport openpyxldef file_checker():    JsonFile = ["AnsCheckTemp.json", "config.json", "FormData.json", "Score.json", "TypeData.json"]    xlsxFile = ["data.xlsx"]    print(colored("Checking whether there are missing files...", "green"))    for e in xlsxFile:        try:            if os.stat("data/" + e).st_size > 0:                print(colored(e + " ✔", "green"))            else:                print(colored(e + " ✗"))                print(colored("Error! Missing File " + e + " can't be repaired! You may have to redownload it", "red"))                sys.exit()        except (OSError):            print(colored(e + " ✗"))            print(colored("Error! Missing File " + e + " can't be repaired! You may have to redownload it", "red"))            sys.exit()        except:            print(colored(e + " ✗"))            print(colored("Error! Missing spreadsheet (Excel) file can't be repaired! You may have to redownload it", "red"))            sys.exit()    for i in JsonFile:        try:            if os.stat("data/json/" + i).st_size > 0:                print(colored(i + " ✔", "green"))            else:                try:                    print(colored(i + " ✗"))                    print(colored("Error! There is a empty file" + i + ". Repairing...", "red"))                    repair(i)                    print(colored(i + "Perfect Done!", "green"))                except:                    print(colored("Error! Missing File " + i + " can't be repaired! You may have to redownload it", "red"))                    sys.exit()        except (OSError):            try:                print(colored(i + " ✗"))                print(colored("Error! There is a missing file " + i + ". Repairing...", "red"))                repair(i)                print(colored(i + "Perfect Done!", "green"))            except:                print(colored("Error! Missing File" + i + "can't be repaired! You may have to redownload it", "red"))                sys.exit()        except:            print(colored("Error! Missing File can't be repaired! You may have to redownload it", "red"))            sys.exit()def repair(filename):    shutil.copy2("data/backup/"+filename, "data/json/"+filename)def default_json():    with open("data/json/Score.json", "r") as sf:        score = json.load(sf)    with open("data/json/TypeData.json", "r") as sf:        type = json.load(sf)    with open("data/json/FormData.json", "r") as sf:        form = json.load(sf)    score["Score"] = {}    type.clear()    form.clear()    with open("data/json/Score.json", "w") as sf:        json.dump(score, sf)    with open("data/json/TypeData.json", "w") as sf:        json.dump(type, sf)    with open("data/json/FormData.json", "w") as sf:        json.dump(form, sf)def default_excel_result():    wb = openpyxl.load_workbook("data/data.xlsx", data_only=True)    try:        try:            wb.remove_sheet(wb["result"])            wb.create_sheet('result')        except:            wb.create_sheet('result')        wb.save("data/data.xlsx")        wb.close()    except (PermissionError):        print(colored("Error! Please save and close data.xlsx and try again!", "red"))        sys.exit()    try:        wb = openpyxl.load_workbook("data/data.xlsx", data_only=True)        sheet = wb['result']        with open("data/json/config.json", "r") as f:            config = json.load(f)        length = len(config["type"]) + len(config["form"])        list = config["form"] + config["type"]        sheet.cell(row=1, column=1).value = "Name"        sheet.cell(row=1, column=2).value = "Total Score"        for i in range(length):            sheet.cell(row=1, column=i+3).value = list[i]        wb.save("data/data.xlsx")        wb.close()    except:        print(colored("Error! Please save and close data.xlsx and try again!", "red"))        sys.exit()def default_excel_resultPercentage():    wb = openpyxl.load_workbook("data/data.xlsx", data_only=True)    try:        try:            wb.remove_sheet(wb["resultPercentage"])            wb.create_sheet('resultPercentage')        except:            wb.create_sheet('resultPercentage')        wb.save("data/data.xlsx")        wb.close()    except (PermissionError):        print(colored("Error! Please save and close data.xlsx and try again!", "red"))        sys.exit()    try:        wb = openpyxl.load_workbook("data/data.xlsx", data_only=True)        sheet = wb['resultPercentage']        with open("data/json/config.json", "r") as f:            config = json.load(f)        length = len(config["type"]) + len(config["form"])        list = config["form"] + config["type"]        sheet.cell(row=1, column=1).value = "Name"        sheet.cell(row=1, column=2).value = "Total Score"        for i in range(length):            sheet.cell(row=1, column=i+3).value = list[i]        wb.save("data/data.xlsx")        wb.close()    except:        print(colored("Error! Please save and close data.xlsx and try again!", "red"))        sys.exit()